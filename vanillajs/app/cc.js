'use strict';let c;const g=/^\/$|top|new|show|ask|job/,h=/story\/(\d+$)/,k="undefined"!==typeof window,l="undefined"!==typeof document;l&&(c=document.querySelector("#a"),document.onclick=a=>{const b=a.target;if(b.dataset.scope||b.href&&b.href.match(h))a.preventDefault(),a=(b.href.match(h)||[])[1],history.pushState(a?{a}:0,"",a?`/story/${a}`:b.href),n(a)});function n(a){null!=a?p(a):(a=window.location.pathname.match(g),q(("/"===a[0]?"top":a[0])+"stories"))}
if(k){window.onpopstate=d=>{n((d.state||0).a)};const a=window.location.pathname.match(g);let b=window.location.pathname.match(h);a?history.replaceState(0,"","/"+("/"===a[0]?"top":a[0])):(b=b[1],history.pushState({a:b},"",`/story/${b}`));n(b)}async function r(a){return await (await fetch(a)).json()}async function q(a){var b=c;a=await r(`/stories.json?scope=${a}&offset=0&num=30`);t(b,a)}
function t(a,b){a.innerHTML="";u=u.bind(this);a.appendChild(b.reduce((d,e)=>d.appendChild(v(e))&&d,u("ul",{id:"stories"})))}function w(a,b,d){d.filter(e=>!e.deleted).map(x).forEach(e=>{a.appendChild(e);b&&y(e.kids,a)})}async function y(a,b){a&&a.length&&(a=await r(`/items.json?ids=${a.join(",")}`),w(b,!0,a))}function x(a){let b=u("ul",0,u("li",0,u("d",0,u("d",0,a.by)),u("p",{innerHTML:a.text})));y(a.kids,b);return b}
async function p(a){c.innerHTML="";var b=await r("https://hacker-news.firebaseio.com/v0"+`/item/${a}.json`);a=u("d",0,v(b,"d",!0));c.appendChild(a);b=await r(`/items.json?ids=${b.kids.join(",")}`);const d=u("ul",0);w(d,!1,b);a.appendChild(d)}function u(a,b=0,d){const e=l?document:this.document,m=e.createElement(a);for(let f in b)m[f]=b[f];[...arguments].slice(2).forEach(f=>m.appendChild("string"===typeof f?e.createTextNode(f||""):f));return m}
function v(a,b="li",d=!1){return u(b,0,u("d",0,u("d",{hidden:void 0===a.idx},`${a.idx+1}.`),u("d",0,u("a",{href:a.url||`/story/${a.id}`},a.title),u("d",0,u("d",0,`${a.score} points |`),u("d",0,`by ${a.by} |`),u("a",{href:`/story/${a.id}`,hidden:void 0===a.descendants},`${a.descendants} comments`)))),u("d",{innerHTML:a.text,hidden:!(d&&void 0!==a.text)}))}"undefined"!==typeof module&&(module.exports={showStories:t});
